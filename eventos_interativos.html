<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Agenda de Eventos</title>
  <style>
    :root{
      --bg:#0f1221; --panel:#171a2b; --panel-2:#1f2340; --accent:#00ffae; --text:#e7e7ee; --muted:#9aa0b4;
      --row-highlight: rgba(0,255,174,.18); --day-highlight: rgba(0,255,174,.22);
    }
    *{box-sizing:border-box}
    body{margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji","Segoe UI Emoji"; background: radial-gradient(1200px 600px at 10% -10%, #2a2d55 0%, transparent 60%), radial-gradient(1000px 600px at 110% 0%, #203046 0%, transparent 55%), var(--bg); color:var(--text)}
    header{position:sticky; top:0; z-index:50; backdrop-filter: blur(6px); background:linear-gradient(0deg,transparent, rgba(0,0,0,.25) 60%); padding:18px 16px; text-align:center; border-bottom:1px solid rgba(255,255,255,.06)}
    h1{margin:0; font-size:clamp(18px,3.2vw,26px)}
    .clock{margin-top:6px; font-size:14px; color:var(--accent)}

    .container{max-width:1200px; margin:18px auto; padding:12px}
    .panel{background:linear-gradient(180deg,var(--panel),var(--panel-2)); border:1px solid rgba(255,255,255,.06); border-radius:16px; box-shadow: 0 10px 30px rgba(0,0,0,.35); overflow:hidden}
    .table-wrap{overflow:auto}
    table{width:100%; border-collapse:separate; border-spacing:0}

    thead th{position:sticky; top:0; background:rgba(255,255,255,.04); color:var(--accent); font-weight:700}
    th, td{padding:10px 12px; text-align:center; border-bottom:1px solid rgba(255,255,255,.06); white-space:nowrap}
    thead th:first-child{left:0; z-index:3}
    tbody th{position:sticky; left:0; z-index:2; background:rgba(255,255,255,.03); color:#b8bfd4; font-weight:600}
    tr.row-highlight{background:var(--row-highlight)}
    .day-highlight{background:var(--day-highlight); color:#00140c}

    .cell{min-width:170px}
    .chips{display:flex; align-items:center; justify-content:center; gap:6px; flex-wrap:wrap}
    .chip{--c:#6bcfff; display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; font-weight:700; color:#08151b; background:linear-gradient(180deg, color-mix(in srgb, var(--c) 80%, #fff 20%), color-mix(in srgb, var(--c) 65%, #000 35%)); box-shadow: inset 0 -1px 0 rgba(0,0,0,.25), 0 6px 16px color-mix(in srgb, var(--c) 25%, transparent); border:1px solid color-mix(in srgb, var(--c) 55%, #000 45%)}
    .sep{opacity:.55; font-weight:700}
    .chip.small{font-size:12px; padding:4px 8px; border-style:dashed}

    .legend{display:flex; gap:10px; flex-wrap:wrap; padding:12px; border-top:1px dashed rgba(255,255,255,.1); color:var(--muted); font-size:12px}
    .legend-item{display:flex; align-items:center; gap:8px}
    .legend-swatch{width:14px; height:14px; border-radius:4px; border:1px solid rgba(0,0,0,.3)}

    .progress{height:8px; width:100%; background:rgba(255,255,255,.08); border-radius:6px; overflow:hidden; margin-top:8px}
    .progress>.bar{height:100%; width:0%; background:linear-gradient(90deg,var(--accent), #7afcd8); transition:width .8s linear}

    @media (max-width: 760px){
      .cell{min-width:140px}
      th, td{padding:8px}
    }
  </style>
</head>
<body>
  <header>
    <h1>Agenda de Eventos</h1>
    <div class="clock" id="clock"></div>
  </header>

  <div class="container">
    <div class="panel">
      <div class="table-wrap">
        <table id="agenda">
          <thead>
            <tr>
              <th>Horário</th>
              <th id="h-Segunda">Segunda</th>
              <th id="h-Terça">Terça</th>
              <th id="h-Quarta">Quarta</th>
              <th id="h-Quinta">Quinta</th>
              <th id="h-Sexta">Sexta</th>
              <th id="h-Sábado">Sábado</th>
              <th id="h-Domingo">Domingo</th>
            </tr>
          </thead>
          <tbody id="agenda-body"></tbody>
        </table>
      </div>
      <div class="legend" id="legend"></div>
    </div>
  </div>

  <script>
    // ---------- CONFIG ----------
    const DIAS = ["Segunda","Terça","Quarta","Quinta","Sexta","Sábado","Domingo"];
    // Ordem de exibição começa às 14:00
    const HORAS = (()=>{ const a=[]; for(let h=14; h<24; h++) a.push(pad2(h)+":00"); for(let h=0; h<14; h++) a.push(pad2(h)+":00"); return a; })();

    // Paleta fixa por nome do evento
    const COLORS = {
      "Chantra Dredgion":"#5dd6ff",
      "Harbinger of Fate":"#7cff9b",
      "Tiak Research Center":"#b48bff",
      "Black Vevium Battlefield":"#ffd166",
      "Incarnate Conquests":"#ff85d1",
      "Temple of Scales & Crimson Temple":"#5eead4",
      "Altar of Avarice & Vorgaltem Citadel":"#fca5a5",
      "Alpheta Beluslan":"#a78bfa",
      "Governor Sunayaka":"#e9f871",
      "Hexad":"#fb7185",
      "Dredgion Interception":"#7dd3fc"
    };

    // Base de eventos (início + duração em minutos) por dia
    // Se days for "Todos", aplica a todos os dias
    const EVENT_LIST = [
      // Battlegrounds (diário)
      { name:"Chantra Dredgion", days:"Todos", start:"02:00", duration:120 },
      { name:"Chantra Dredgion", days:"Todos", start:"15:00", duration:120 },
      { name:"Harbinger of Fate", days:"Todos", start:"00:00", duration:60 },
      { name:"Harbinger of Fate", days:"Todos", start:"14:00", duration:30 },
      // Tiak / Black Vevium (dias específicos)
      { name:"Tiak Research Center", days:["Terça","Quarta","Sexta"], start:"00:00", duration:120 },
      { name:"Black Vevium Battlefield", days:["Segunda","Quarta","Sexta"], start:"01:00", duration:120 },
      // Short Events (diário)
      { name:"Incarnate Conquests", days:"Todos", start:"22:00", duration:15 },
      // Sieges
      { name:"Temple of Scales & Crimson Temple", days:["Terça"], start:"23:00", duration:60 },
      { name:"Temple of Scales & Crimson Temple", days:["Domingo"], start:"20:00", duration:60 },
      { name:"Altar of Avarice & Vorgaltem Citadel", days:["Quinta"], start:"23:00", duration:60 },
      { name:"Altar of Avarice & Vorgaltem Citadel", days:["Domingo"], start:"20:00", duration:60 },
      { name:"Alpheta Beluslan", days:["Quarta","Sábado"], start:"23:00", duration:60 },
      // Raids
      { name:"Governor Sunayaka", days:["Sexta","Sábado"], start:"00:00", duration:60 },
      { name:"Hexad", days:["Quarta","Domingo"], start:"00:00", duration:60 },
      { name:"Dredgion Interception", days:["Terça","Quinta"], start:"00:00", duration:60 }
    ];

    // ---------- HELPERS ----------
    function pad2(n){ return String(n).padStart(2,'0'); }
    function toMinutes(hhmm){ const [H,M]=hhmm.split(':').map(Number); return H*60+M; }
    function fromMinutes(m){ return pad2(Math.floor((m%1440)/60))+":"+pad2(m%60); }

    // Expande eventos para ocupar todas as horas em que estão ativos
    function buildMatrix(){
      // matrix[hora][dia] = array de eventos (cada item: {name, start, end, duration, isShort})
      const matrix = {}; HORAS.forEach(h=>matrix[h]={});
      const allDays = DIAS;

      EVENT_LIST.forEach(ev=>{
        const days = ev.days === "Todos" ? allDays : ev.days;
        const startMin = toMinutes(ev.start);
        const endMin = (startMin + ev.duration) % 1440; // wrap

        days.forEach(dia=>{
          // Para cada hora HH:00 em que o evento está aberto, adiciona ao slot
          // Percorre em steps de 60 min a partir do início até antes de end
          let t = startMin;
          do {
            const slot = fromMinutes(t - (t%60)); // início da hora daquele instante
            if(!matrix[slot][dia]) matrix[slot][dia] = [];
            matrix[slot][dia].push({
              name: ev.name,
              start: ev.start,
              duration: ev.duration,
              end: fromMinutes(startMin + ev.duration),
              isShort: ev.duration < 60
            });
            t = (Math.floor(t/60)+1)*60; // vai pra próxima hora cheia
            t %= 1440;
          } while (startMin < endMin ? (t < endMin && t > startMin) : (t < endMin || t > startMin));
        });
      });
      return matrix;
    }

    // ---------- RENDER ----------
    const matrix = buildMatrix();
    const tbody = document.getElementById('agenda-body');

    HORAS.forEach(h => {
      const tr = document.createElement('tr');
      const th = document.createElement('th');
      th.textContent = h; tr.appendChild(th);

      DIAS.forEach(dia => {
        const td = document.createElement('td'); td.className='cell';
        const wrap = document.createElement('div'); wrap.className='chips';
        const list = matrix[h][dia] || [];
        list.forEach((item, idx) => {
          const chip = document.createElement('span'); chip.className='chip';
          chip.style.setProperty('--c', COLORS[item.name] || '#6bcfff');
          chip.textContent = item.name + (item.isShort ? ` (⏱️ ${item.duration}m)` : '');
          wrap.appendChild(chip);
          if(idx < list.length-1){ const sep=document.createElement('span'); sep.className='sep'; sep.textContent='|'; wrap.appendChild(sep); }
        });
        td.appendChild(wrap);
        tr.appendChild(td);
      });

      tbody.appendChild(tr);
    });

    // Cria legenda de cores
    const legend = document.getElementById('legend');
    Object.entries(COLORS).forEach(([name,color])=>{
      const li = document.createElement('div'); li.className='legend-item';
      li.innerHTML = `<span class="legend-swatch" style="background:${color}"></span> ${name}`;
      legend.appendChild(li);
    });

    // ---------- RELÓGIO + DESTAQUES + PROGRESSO ----------
    function updateNow(){
      const now = new Date();
      document.getElementById('clock').textContent = now.toLocaleTimeString('pt-BR');

      // Destacar linha da hora atual (considerando a ordem que inicia às 14:00)
      const hr = now.getHours();
      const currentSlot = pad2(hr)+":00";
      const rowIndex = HORAS.indexOf(currentSlot);
      document.querySelectorAll('#agenda tbody tr').forEach(tr=>tr.classList.remove('row-highlight'));
      if(rowIndex>=0){ document.querySelectorAll('#agenda tbody tr')[rowIndex].classList.add('row-highlight'); }

      // Destacar dia atual no cabeçalho
      const dowIdx = (now.getDay() + 6) % 7; // segunda=0 ... domingo=6
      DIAS.forEach((d,i)=> document.getElementById('h-'+d).classList.toggle('day-highlight', i===dowIdx));

      // Barra de progresso por célula do dia atual
      // Remove barras antigas
      document.querySelectorAll('.progress').forEach(p=>p.remove());
      if(rowIndex>=0){
        const row = document.querySelectorAll('#agenda tbody tr')[rowIndex];
        const cell = row.children[dowIdx+1]; // +1 por causa da coluna Horário
        const textCombined = (cell.textContent||'').toLowerCase();
        if(textCombined.trim()){ // existe algo no horário
          // Decidir duração do evento do dia atual neste slot:
          // Se houver vários, pega a maior duração que cobre o slot (melhor feedback visual)
          const items = (matrix[currentSlot][DIAS[dowIdx]]||[]);
          let dur = 60; // default slot
          if(items.length){ dur = Math.max(...items.map(i=>i.duration)); }
          const mins = now.getMinutes();
          const pct = Math.min(100, (mins / dur) * 100);
          const bar = document.createElement('div'); bar.className='progress';
          const inner = document.createElement('div'); inner.className='bar'; inner.style.width = pct+"%";
          bar.appendChild(inner); cell.appendChild(bar);
        }
      }
    }

    updateNow();
    setInterval(updateNow, 1000);
  </script>
</body>
</html>
